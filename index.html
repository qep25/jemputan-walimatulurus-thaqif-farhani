<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Walimatulurus ‚Äî Thaqif & Farhani</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Pinyon+Script&family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">

  <style>
    :root { --card-bg: rgba(255,255,255,0.92); }
    body {
      font-family: 'Poppins', sans-serif;
      background: #f8f7f5;
      color: #1f2937;
      scroll-behavior: smooth;
    }

    /* Hero section */
    .hero {
      background: url('img/Bg.png') center center / cover no-repeat;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #fff;
      position: relative;
    }
    .hero::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.45));
      z-index: 0;
    }
    .hero .content {
      position: relative;
      z-index: 2;
      animation: fadeUp .9s ease both;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: none; }
    }

    .font-pinyon {
      font-family: 'Pinyon Script', cursive;
      font-size: 4rem;
      line-height: 1;
    }

    .overlay-card {
      background: var(--card-bg);
      border-radius: 1rem;
      box-shadow: 0 6px 24px rgba(15,23,42,0.08);
    }

    /* Transparent button */
    .btn-transparent {
      background: transparent;
      color: #fff;
      border: 2px solid rgba(255,255,255,0.9);
      transition: .22s;
    }
    .btn-transparent:hover {
      background: rgba(255,255,255,0.12);
      transform: scale(1.03);
    }

    /* Music control */
    .music-control {
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 9999;
    }

    /* === Bottom Nav (Frosted Style) === */
    #bottomNav {
      backdrop-filter: blur(12px);
      background: rgba(255, 255, 255, 0.7);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 -2px 12px rgba(0,0,0,0.08);
      transform: translateY(100%);
      transition: transform 0.4s ease;
      z-index: 9998;
    }

    #bottomNav a {
      flex: 1;
      padding: 6px 0;
      color: #1f2937;
      transition: all 0.25s ease;
      text-decoration: none;
    }
    #bottomNav a:hover {
      background: rgba(255, 255, 255, 0.3);
      color: #db2777;
      transform: scale(1.05);
    }
    #bottomNav a.active {
      color: #f6b4c2;
      font-weight: 600;
      transform: scale(1.1);
    }
    #bottomNav a span {
      display: block;
      font-size: 0.75rem;
    }

    @media (max-width: 768px) {
      .font-pinyon { font-size: 2.6rem; }
      .hero { padding: 2rem; }
      #bottomNav a span { font-size: 0.7rem; }
    }
  </style>
</head>
<body>

  <!-- AUDIO -->
  <audio id="bgMusic" loop>
    <source src="img/Bg.mp3" type="audio/mpeg">
  </audio>

  <!-- MUSIC CONTROL -->
  <div class="music-control">
    <button id="musicToggle" class="btn btn-sm btn-outline-dark">‚è∏ Pause</button>
  </div>

  <!-- HERO SECTION -->
  <section class="hero">
    <div class="content">
      <h3 class="text-uppercase small mb-1">Walimatulurus</h3>
      <h1 class="font-pinyon mb-1">Thaqif & Farhani</h1>
      <p class="mb-2">6 Jun 2026 ‚Ä¢ #HANInoesQEP</p>
      <button onclick="startMusicAndScroll()" class="btn btn-transparent px-4 py-2 rounded-pill">üíå Lihat Jemputan</button>
    </div>
  </section>

  <!-- MAIN CONTENT -->
  <main id="main-card" class="container position-relative">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-md-10 col-sm-12 position-relative" style="margin-bottom:3rem;">
        <div class="overlay-card p-4 p-md-5">

          <!-- Header -->
          <div class="text-center mb-3">
            <h4 class="fw-semibold" style="color:#db2777;">Satukan Hati, Jalin Kasih, Dalam Ikatan Suci Pernikahan Kami.</h4>
          </div>

          <!-- Intro -->
          <div id="intro" class="bg-white rounded-4 p-4 mb-4 text-center">
            <p class="mb-3">Assalamualaikum wbt & salam sejahtera,</p>

            <p class="fst-italic mb-3">
              Sirih junjung berbalas pantun,<br>
              Berarak kasih menuju pelaminan,<br>
              Dengan rasa hormat dan penuh santun,<br>
              Kami hulurkan undangan ke majlis perkahwinan.
            </p>

            <p class="mb-3">
              Dengan penuh kesyukuran kami menjemput<br>
              <strong>Dato‚Äô | Datin | Tuan | Puan | Encik | Cik</strong><br>
              ke majlis perkahwinan
            </p>

            <h5 class="fw-semibold text-uppercase mt-3 mb-1" style="color:#db2777;">DANIAL THAQIF BIN MOHAMED FIKRI</h5>
            <span class="fw-semibold">&</span>
            <h5 class="fw-semibold text-uppercase mt-1 mb-3" style="color:#db2777;">NORFARHANI BINTI MOHD YUSOFF</h5>

            <p class="mb-1">pada</p>
            <h5 class="fw-semibold mb-3">SABTU, 6 JUN 2026</h5>

            <p class="mb-1">yang bertempat di</p>
            <h6 class="fw-semibold mb-3">KT BALLROOM SHAH ALAM, SEKSYEN 24</h6>

            <p class="fst-italic text-muted small">
              Hadirlah memeriahkan hari bersejarah ini,<br>
              moga bersatu doa dan restu dalam kasih Ilahi.
            </p>
          </div>


          <!-- Butiran -->
          <div id="butiran" class="bg-white rounded-4 p-3 mb-4">
            <h4 class="mb-2">Butiran Majlis</h4>
            <ul class="mb-3 small list-unstyled">
              <li><strong>Tarikh:</strong> Sabtu, 2 Mei 2026</li>
              <li><strong>Masa:</strong> 12:00 tengah hari ‚Äì 4:00 petang</li>
              <li><strong>Tempat:</strong> KT Ballroom Shah Alam, Seksyen 24</li>
            </ul>
            <div class="d-flex justify-content-center gap-2 flex-wrap">
              <a href="#" class="btn btn-outline-primary" id="gmapBtn" target="_blank">Google Maps</a>
              <a href="#" class="btn btn-outline-secondary" id="wazeBtn" target="_blank">Waze</a>
            </div>
          </div>

          <!-- RSVP FORM -->
          <div id="rsvp" class="bg-white rounded-4 p-3 mb-4">
          <h4 class="mb-3">RSVP & Ucapan</h4>
          <form id="rsvpForm"
            action="https://script.google.com/macros/s/AKfycbx2IDA-6RXkLB8wu5OXi7m9j1GoZdXfjFBeZnYmHFx_MbtarnLJwEN54p8SRG2O7K4PlA/exec"
            method="POST"
            target="hidden_iframe"
            onsubmit="handleSubmit(event)">

            <!-- Nama -->
            <div class="mb-3">
              <label for="nama" class="form-label">Nama</label>
              <input id="nama" name="nama" type="text" required class="form-control">
            </div>

            <!-- Kehadiran -->
            <div class="mb-3">
              <label class="form-label d-block" for="hadir">Kehadiran</label>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hadir" id="hadirYa" value="Hadir" required>
                <label class="form-check-label" for="hadirYa">Hadir</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hadir" id="hadirTidak" value="Tidak Hadir" required>
                <label class="form-check-label" for="hadirTidak">Tidak Hadir</label>
              </div>
            </div>

            <!-- Bilangan -->
            <div class="mb-3">
              <label for="bilangan" class="form-label">Bilangan</label>
              <select id="bilangan" name="bilangan" required class="form-select">
                <option value="">Pilih...</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
              </select>
            </div>

            <!-- Ucapan -->
            <div class="mb-3">
              <label for="ucapan" class="form-label">Jika Ada Ucapan</label>
              <textarea id="ucapan" name="ucapan" rows="3" class="form-control"></textarea>
            </div>

            <button id="submitBtn" type="submit" class="btn btn-primary w-100">Hantar</button>
          </form>

          <div id="formResponse" class="mt-3"></div>
          <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>
        </div>

          <!-- UCAPAN -->
          <div id="ucapanLi" class="bg-white rounded-4 p-3 mb-4" id="ucapanListContainer">
            <h4 class="mb-3">Ucapan Daripada Tetamu</h4>
            <div id="ucapanList" class="small text-dark">
              <p>Memuatkan ucapan‚Ä¶</p>
            </div>
          </div>

          <!-- Salam Kaut -->
          <div id="salamKaut" class="bg-white rounded-4 p-3 mb-4 text-center">
            <h5 class="mb-2">Salam Kaut & Hadiah</h5>
            <p class="small mb-1"><strong>Bank Islam</strong></p>
            <p class="mb-1">No Akaun: <strong>12159020271854</strong></p>
            <p class="mb-1">Atas nama: <strong>Danial Thaqif bin Mohamed Fikri</strong></p>
            <div class="mt-3 d-flex justify-content-center">
              <img src="img/QRCodeThaqif.jpg" alt="QR Thaqif" class="rounded shadow" style="width:120px;height:120px;object-fit:cover;">
            </div>
          </div>

          <!-- Contact -->
          <div class="bg-white rounded-4 p-3 text-center">
            <p>Untuk pertanyaan: <a href="https://wa.me/601163501549" target="_blank" class="text-decoration-none">WhatsApp</a></p>
          </div>

        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="text-center py-3 text-muted">
    Made by Danial Thaqif ¬© 2025
  </footer>

  <!-- BOTTOM NAVBAR -->
  <nav id="bottomNav" class="fixed-bottom d-flex justify-content-around py-2">
    <a href="#intro" class="text-center small fw-medium">
      <div>üè†</div><span>Utama</span>
    </a>
    <a href="#butiran" class="text-center small fw-medium">
      <div>üìÖ</div><span>Butiran</span>
    </a>
    <a href="#rsvp" class="text-center small fw-medium">
      <div>üíå</div><span>RSVP</span>
    </a>
    <a href="#ucapanLi" class="text-center small fw-medium">
      <div>üíñ</div><span>Ucapan</span>
    </a>
    <a href="#salamKaut" class="text-center small fw-medium">
      <div>üéÅ</div><span>Salam Kaut</span>
    </a>
  </nav>


  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const SCRIPT_ENDPOINT = "https://script.google.com/macros/s/AKfycbx2IDA-6RXkLB8wu5OXi7m9j1GoZdXfjFBeZnYmHFx_MbtarnLJwEN54p8SRG2O7K4PlA/exec";
    const music = document.getElementById('bgMusic');
    const musicBtn = document.getElementById('musicToggle');
    let isPlaying = false;

    window.addEventListener('load', () => {
      music.play().then(() => {
        isPlaying = true;
        musicBtn.textContent = '‚è∏ Pause';
      }).catch(() => {
        isPlaying = false;
        musicBtn.textContent = '‚ñ∂ Play';
      });
      loadUcapan();
    });

    musicBtn.addEventListener('click', () => {
      if (isPlaying) {
        music.pause();
        musicBtn.textContent = '‚ñ∂ Play';
      } else {
        music.play().then(() => musicBtn.textContent = '‚è∏ Pause');
      }
      isPlaying = !isPlaying;
    });

    async function loadUcapan() {
      const list = document.getElementById('ucapanList');
      list.innerHTML = '<p>Memuatkan ucapan‚Ä¶</p>';

      try {
        const res = await fetch(`https://corsproxy.io/?${encodeURIComponent(SCRIPT_ENDPOINT)}`, { cache: "no-store" });
        const data = await res.json();

        if (!data || !data.length) {
          list.innerHTML = '<p>Tiada ucapan lagi.</p>';
          return;
        }

        // ‚úÖ Filter only valid ucapan (not empty or '-')
        const validUcapan = data.filter(item =>
          item.ucapan && item.ucapan.trim() !== '-' && item.ucapan.trim() !== ''
        );

        if (validUcapan.length === 0) {
          list.innerHTML = '<p>Tiada ucapan lagi.</p>';
          return;
        }

        // ‚úÖ Display valid ucapan only
        list.innerHTML = validUcapan.map(item => `
          <div class="border-bottom pb-2 mb-2">
            <p class="mb-1"><em>${escapeHtml(item.ucapan)}</em></p>
            <p class="mb-0 small fw-semibold text-muted">‚Äî ${escapeHtml(item.nama || '-')}</p>
          </div>
        `).join('');
      } catch (err) {
        console.error('Load ucapan error', err);
        list.innerHTML = '<p>Gagal memuatkan ucapan.</p>';
      }
    }


    function escapeHtml(s) {
      if (!s) return '';
      return s.replaceAll('&','&amp;')
              .replaceAll('<','&lt;')
              .replaceAll('>','&gt;')
              .replaceAll('"','&quot;')
              .replaceAll("'",'&#039;');
    }

    document.getElementById('hidden_iframe').addEventListener('load', function(){
      setTimeout(loadUcapan, 800);
    });

    // === Handle Form Submission ===
    function handleSubmit(e) {
      e.preventDefault();
      const form = e.target;
      const submitBtn = document.getElementById('submitBtn');
      const resBox = document.getElementById('formResponse');

      // Disable button + show loading spinner
      submitBtn.disabled = true;
      resBox.innerHTML = `
        <div class="text-center mt-3 text-muted">
          <div class="spinner-border spinner-border-sm" style="color:#f6b4c2;" role="status"></div>
          <span class="ms-2">Sedang menghantar...</span>
        </div>
      `;

      fetch(form.action, {
        method: "POST",
        body: new FormData(form),
        mode: "no-cors"
      })
      .then(() => {
        resBox.innerHTML = '<div class="alert alert-success mt-3">‚úÖ Terima kasih! Ucapan anda telah dihantar.</div>';
        form.reset();
        setTimeout(() => resBox.innerHTML = '', 20000);
        submitBtn.disabled = false;
        setTimeout(loadUcapan, 1000);
      })
      .catch(() => {
        resBox.innerHTML = '<div class="alert alert-danger mt-3">‚ùå Tidak Dapat Menghantar (ERROR).</div>';
        submitBtn.disabled = false;
      });
    }


    // === Bottom Navigation Visibility & Active Highlight ===
    const bottomNav = document.getElementById('bottomNav');
    const navLinks = bottomNav.querySelectorAll('a');
    let navVisible = false;

    function showBottomNav() {
      bottomNav.style.transform = 'translateY(0)';
      navVisible = true;
    }

    function hideBottomNav() {
      bottomNav.style.transform = 'translateY(100%)';
      navVisible = false;
    }

    window.addEventListener('scroll', () => {
      const scrollY = window.scrollY;
      const heroHeight = window.innerHeight * 0.4;

      if (scrollY > heroHeight && !navVisible) showBottomNav();
      else if (scrollY <= heroHeight && navVisible) hideBottomNav();

      highlightCurrentSection();
    });

    function startMusicAndScroll() {
      if (!isPlaying) {
        music.play().then(() => {
          isPlaying = true;
          musicBtn.textContent = '‚è∏ Pause';
        });
      }
      document.getElementById('main-card').scrollIntoView({ behavior: 'smooth' });
      showBottomNav();
    }

    function highlightCurrentSection() {
      const sections = [
        { id: 'intro', link: navLinks[0] },
        { id: 'lokasi', link: navLinks[1] },
        { id: 'rsvp', link: navLinks[2] },
        { id: 'ucapanLi', link: navLinks[3] },
        { id: 'salamKaut', link: navLinks[4] }
      ];

      let scrollPos = window.scrollY + window.innerHeight / 2;
      sections.forEach(({ id, link }) => {
        const section = document.getElementById(id);
        if (!section) return;
        const top = section.offsetTop;
        const height = section.offsetHeight;
        if (scrollPos >= top && scrollPos < top + height) {
          navLinks.forEach(a => a.classList.remove('active'));
          link.classList.add('active');
        }
      });
    }

    // === Disable/Enable Bilangan Based on Kehadiran ===
    const hadirRadios = document.querySelectorAll('input[name="hadir"]');
    const bilanganSelect = document.getElementById('bilangan');

    hadirRadios.forEach(radio => {
      radio.addEventListener('change', () => {
        if (radio.value === "Tidak Hadir" && radio.checked) {
          bilanganSelect.value = "";
          bilanganSelect.disabled = true;
          bilanganSelect.classList.add("bg-light");
        } else if (radio.value === "Hadir" && radio.checked) {
          bilanganSelect.disabled = false;
          bilanganSelect.classList.remove("bg-light");
        }
      });
    });


    setInterval(loadUcapan, 30000);

    document.getElementById('gmapBtn').href = 'https://maps.app.goo.gl/XZkmqM8EtiQRAhgU8';
    document.getElementById('wazeBtn').href = 'https://ul.waze.com/ul?venue_id=66519070.665321776.636612&overview=yes&utm_campaign=default&utm_source=waze_website&utm_medium=lm_share_location';
  </script>
</body>
</html>
